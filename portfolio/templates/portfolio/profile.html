{% extends 'portfolio/base/base-with-navigation.html' %}
{% load static %}
{% load portfolio_tags %}

{% static 'portfolio/images/hurtRED.png' as red_heart %}
{% static 'portfolio/images/hurtEMPTY.png' as empty_heart %}

{% block style_load %}
    <link rel="stylesheet" href="{% static 'portfolio/css/profile page.css' %}"/>
{% endblock %}

{% block main %}
    <section>
        <div class="profile-information">
            {% if user_profile.image %}
                <img class="image" src="{{ user_profile.image.url }}" alt="Фото профиля">
            {% else %}
                <img class="image" src="{% static 'portfolio/images/profileNO.png' %}" alt="Фото профиля">
            {% endif %}
            <div class="main-information">
                <p class="name">{{ user_profile }}</p>
                <ul>
                    <li class="age">
                        {% if user_profile.date_of_birth %}
                            <p>Возраст: {{ user_profile.get_user_age }}</p>
                        {% endif %}
                    </li>
                    <li class="activity">
                        {% if user_profile.scope_of_work %}
                            <p>Сфера деятельности: {{ user_profile.scope_of_work }}</p>
                        {% endif %}
                    </li>
                    <li class="city">
                        {% if user_profile.city %}
                            <p>Город: {{ user_profile.city }}</p>
                        {% endif %}
                    </li>
                    <li class="telephone">
                        {% if user_profile.phone_number %}
                            <p>Телефон: {{ user_profile.phone_number }}</p>
                        {% endif %}
                    </li>
                    <li class="email">
                        {% if user_profile.email %}
                            <p>Электронная почта: {{ user.email }}</p>
                        {% endif %}
                    </li>
                </ul>
                <div class="tags">
                    {% for tag in user_profile.tags %}
                        <p>{{ tag }}</p>
                    {% endfor %}
                </div>

                {% if user_profile.text %}
                    <div class="about-me">
                        <p class="about">О себе</p>
                        <p>{{ user_profile.text }}</p>
                    </div>
                {% endif %}

                {% if user.social_networks.all|length > 0 %}
                    <div class="social-networks">
                        {% for social_network in user.social_networks.all %}
                            <a href="{{ social_network.link }}" target="_blank">
                                <img src="{% static social_network.get_image_url %}">
                            </a>
                        {% endfor %}
                    </div>
                {% endif %}

            </div>
        </div>
        <div class="create-post">
            <a href="{% url 'create_post' user_profile.nickname %}">
                <img id="create-post" src="{% static 'portfolio/images/create post.svg' %}"
                     alt="Создать пост(картинка)">
                <p>Создать пост</p>
                <img id="arrow-right" src="{% static 'portfolio/images/post-arrow-right.svg' %}"
                     alt="Редактировать и создать пост">
            </a>
        </div>
    </section>

    <section class="posts">
        {% for post in posts %}
            <div class="post">
                <div class="photo">
                    {% if user_profile.image %}
                        <img src="{{ user_profile.image.url }}" alt="Фото профиля">
                    {% else %}
                        <img src="{% static 'portfolio/images/profileNO.png' %}" alt="Фото профиля">
                    {% endif %}
                </div>
                
                <div class="post-information">
                    {% if post.title %}
                        <p class="post-name">{{ post.title }}</p>
                    {% endif %}
                    
                    {% if post.post_type %}
                        <p class="post-type">{{ post.post_type }}</p>
                    {% endif %}
                    
                    <div class="tags">
                        {% for tag in post.tags.all %}
                            <p>{{ tag }}</p>
                        {% endfor %}
                    </div>
                    
                   
                    {% if post.photos %}
                        <section class="post-image">

                            <button class="slide-arrow" id="slide-arrow-prev">
                                &#8249;
                            </button>
                            <button class="slide-arrow" id="slide-arrow-next">
                                &#8250;
                            </button>
                            <ul class="slides-container" id="slides-container">
                            {% for photo in post.photos.all %}
                                

                                    <li class="slide"><img class="user-image" src="{{ photo.file.url }}"></li>

                            {% endfor %}
                        </ul>
                        </section>
                        <script src="{% static 'portfolio/js/carusel.js' %}"></script>
                    {% endif %}
                    
                    {% if post.text %}
                        <p class="post-description">{{ post.text }}</p>
                    {% endif %}
                    {% if post.videos %}
                        {% for video in post.videos.all %}
                            <video
                                    id="my-video"
                                    class="video-js"
                                    controls
                                    preload="auto"
                                    width="640"
                                    height="264"
                                    poster="MY_VIDEO_POSTER.jpg"
                                    data-setup="{}"
                            >
                            <source src="MY_VIDEO.mp4" type="video/mp4"/>
                            <source src="MY_VIDEO.webm" type="video/webm"/>
                            </video>
                        {% endfor %}
                    {% endif %}
                    {% if post.date %}
                        <p class="date">{{ post.date }}</p>
                    {% endif %}
                    {% if post.genre %}
                        <p>Жанр: {{ post.get_genre_display }}</p>
                    {% endif %}
                    {% if post.style %}
                        <p>Стиль: {{ post.style }}</p>
                    {% endif %}
                    {% if post.budget %}
                        <p>Бюджет: {{ post.budget }}</p>
                    {% endif %}
                    {% if post.age_limit %}
                        <p>Возрастные ограничения: {{ post.age_limit }}</p>
                    {% endif %}
                    {% if post.files %}
                        <div class="script">
                            {% for user_file in post.files.all %}
                                <a href="{{ user_file.file.url }}" download="{{ user_file }}">
                                    <img src="{% static 'portfolio/images/file.png' %}" alt="{{ user_file.file.name }}">
                                    <p>{{ user_file }}</p>
                                    <img class="right"src="{% static 'portfolio/images/post-arrow-right.svg' %}" width="14"
                                         height="20"
                                         alt="Стрелка вправо">
                                </a>
                            {% endfor %}
                        </div>
                       
                    {% endif %}
                </div>
                
                
                    <div class="icons">
                        <button type="button" class="favourites">
                            <img src="{% static 'portfolio/images/three dorts.png' %}" alt="Настройки">
                        </button>
                        <div class="post-menu">
                            <ul>
                                <li class="edit"><a href="{% url 'edit_post' post.post_slug %}">Редактировать пост</a></li>
                                <li class="edit"><a href="{% url 'delete_post' post.pk %}">Удалить пост</a></li>
                            </ul>
                        </div>
                    </div>
                    
                
                
                <div class="like">
                    <p>{{ post.get_count_likes }}</p>
                    {% if request.user != user %}
                        {% is_liked post request.user as liked %}
                        {% if liked %}
                            <a href="{% url 'dislike_post' post.pk %}">
                                <img src="{% static 'portfolio/images/hurtRED.png' %}" alt="Красное сердечко">
                            </a>
                        {% else %}
                            <a href="{% url 'like_post' post.pk %}">
                                <img src="{% static 'portfolio/images/hurtEMPTY.png' %}" alt="Пустое сердечко">
                            </a>
                        {% endif %}
                    {% else %}
                        <a href="#">
                            <img src="{% static 'portfolio/images/hurtRED.png' %}" alt="Сердечко">
                        </a>
                    {% endif %}
                    </div>
                
            </div>
        {% endfor %}
    </section>
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
{% endblock %}